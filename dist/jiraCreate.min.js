!function(e){e.module("jiraCreate",[]).provider("JIRA",function(){var t={};this.$get=["$http","$filter","$q",function(i,r,s){return t.encloseInObject=function(e){return{value:e}},t.generateField=function(e,i){if(e.value)return e.value;if(i[e.inquiryField]){var r=e.map?e.map[i[e.inquiryField]]:i[e.inquiryField];return r=e.filter?e.filter(r):r,e.encloseInObject?t.encloseInObject(r):r}},t.createIssue=function(e,t,i){return{fields:{summary:e,issuetype:{name:t},project:{key:i}}}},t.issuePath=t.issuePath||"/rest/api/2/issue",t.defaultProxy=t.defaultProxy||"/jira-form-proxy.php?url=",t.postItem=function(e,r,s){return i.post((s||t.defaultProxy)+(r||t.defaultServer)+t.issuePath,e)},t.submitRequest=function(i,s){s.onSubmit&&s.onSubmit();var n=e.isString(s.summary)?s.summary:s.summary(i),u=e.isString(s.issueType)?s.issueType:s.issueType(i),o=e.isString(s.projectKey)?s.projectKey:s.projectKey(i),a=t.createIssue(n,u,o);return e.forEach(s.commonFields,function(e,r){a.fields[r]=t.generateField(e,i)}),e.isDefined(s.issueTypes)&&e.forEach(s.issueTypes[a.fields.issuetype.name],function(e,r){a.fields[r]=t.generateField(e,i)}),a.fields[s.inquiryDumpField]=r("json")(i),t.postItem(r("json")(a),s.server,s.proxyUrl)},t}],this.setJIRAIssueCreationPath=function(e){t.issuePath=e},this.setServer=function(e){t.defaultServer=e},this.setProxy=function(e){t.defaultProxy=e}})}(window.angular);